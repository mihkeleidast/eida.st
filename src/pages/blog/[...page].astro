---
import Base from '../../layouts/Base.astro';

import Container from '../../components/Container.astro';
import Prose from '../../components/Prose.astro';
import { MarkdownInstance } from 'astro';
import Paginator from '../../components/Paginator.astro';

interface Post {
    date: string;
    title: string;
    description: string;
}

export async function getStaticPaths({ paginate }) {
    const PAGE_SIZE = 1;
    const allPosts: MarkdownInstance<Post>[] = await Astro.glob('./posts/*.md');
    const sortedPosts = allPosts.sort((a, b) => new Date(b.frontmatter.date).getTime() - new Date(a.frontmatter.date).getTime());

    return paginate(sortedPosts, {
      pageSize: PAGE_SIZE
    })
}
const { page } = Astro.props
const data: MarkdownInstance<Post>[] = page.data;
---
<Base title="blog - mihkel eidast">
    <Container>
        <Prose>
            <h1>Blog</h1>
            <ul>
                {data.map((post) => (
                    <li>
                        <article>
                            <h2><a href={post.url}>{post.frontmatter.title}</a></h2>
                            <p>{post.frontmatter.description}</p>
                        </article>
                    </li>
                ))}
            </ul>
            <Paginator page={page} />
        </Prose>
    </Container>
</Base>

<style>
    ul {
        padding: 0;
        list-style: none;
    }
</style>

